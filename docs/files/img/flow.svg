<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1176" height="737" contentScriptType="application/ecmascript" contentStyleType="text/css" style="width:1176px;height:737px" preserveAspectRatio="none" version="1.1" viewBox="0 0 1176 737" zoomAndPan="magnify"><defs><filter id="ffq9v8etzm3dj" width="300%" height="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4" dy="4" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect style="stroke:#a80036;stroke-width:1" width="10" height="420.992" x="79" y="219.731" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#a80036;stroke-width:1" width="10" height="29.311" x="401" y="190.42" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#a80036;stroke-width:1" width="10" height="29.311" x="401" y="292.352" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#a80036;stroke-width:1" width="10" height="544.234" x="586.5" y="96.488" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#a80036;stroke-width:1" width="10" height="479.613" x="869.5" y="161.109" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#a80036;stroke-width:1" width="10" height="29.311" x="1102.5" y="492.525" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#000;stroke-width:2" width="652.5" height="149.508" x="502" y="453.904" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:none;stroke-width:1" width="652.5" height="44.266" x="502" y="559.146" fill="#FFF"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:5,5" x1="84" x2="84" y1="86.488" y2="649.723"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:5,5" x1="406" x2="406" y1="86.488" y2="649.723"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:5,5" x1="591" x2="591" y1="86.488" y2="649.723"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:5,5" x1="874.5" x2="874.5" y1="86.488" y2="649.723"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:5,5" x1="1107.5" x2="1107.5" y1="86.488" y2="649.723"/><text x="8" y="83.535" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="146">Requesting Party (RP)</text><ellipse cx="84" cy="13" fill="#FFF" filter="url(#ffq9v8etzm3dj)" rx="8" ry="8" style="stroke:#a80036;stroke-width:2"/><path fill="none" d="M84,21 L84,48 M71,29 L97,29 M84,48 L71,63 M84,48 L97,63" filter="url(#ffq9v8etzm3dj)" style="stroke:#a80036;stroke-width:2"/><text x="8" y="662.258" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="146">Requesting Party (RP)</text><ellipse cx="84" cy="675.211" fill="#FFF" filter="url(#ffq9v8etzm3dj)" rx="8" ry="8" style="stroke:#a80036;stroke-width:2"/><path fill="none" d="M84,683.2109 L84,710.2109 M71,691.2109 L97,691.2109 M84,710.2109 L71,725.2109 M84,710.2109 L97,725.2109" filter="url(#ffq9v8etzm3dj)" style="stroke:#a80036;stroke-width:2"/><rect style="stroke:#a80036;stroke-width:1.5" width="188" height="30.488" x="310" y="51" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><text x="317" y="71.535" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="174">Authorization Server (AS)</text><rect style="stroke:#a80036;stroke-width:1.5" width="188" height="30.488" x="310" y="648.723" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><text x="317" y="669.258" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="174">Authorization Server (AS)</text><rect style="stroke:#a80036;stroke-width:1.5" width="155" height="30.488" x="512" y="51" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><text x="519" y="71.535" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141">Resource Server (RS)</text><rect style="stroke:#a80036;stroke-width:1.5" width="155" height="30.488" x="512" y="648.723" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><text x="519" y="669.258" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141">Resource Server (RS)</text><rect style="stroke:#a80036;stroke-width:1.5" width="134" height="30.488" x="805.5" y="51" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><text x="812.5" y="71.535" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120">PartProtector (PP)</text><rect style="stroke:#a80036;stroke-width:1.5" width="134" height="30.488" x="805.5" y="648.723" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><text x="812.5" y="669.258" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120">PartProtector (PP)</text><rect style="stroke:#a80036;stroke-width:1.5" width="70" height="30.488" x="1070.5" y="51" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><text x="1077.5" y="71.535" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56">WebPart</text><rect style="stroke:#a80036;stroke-width:1.5" width="70" height="30.488" x="1070.5" y="648.723" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><text x="1077.5" y="669.258" fill="#000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56">WebPart</text><rect style="stroke:#a80036;stroke-width:1" width="10" height="420.992" x="79" y="219.731" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#a80036;stroke-width:1" width="10" height="29.311" x="401" y="190.42" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#a80036;stroke-width:1" width="10" height="29.311" x="401" y="292.352" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#a80036;stroke-width:1" width="10" height="544.234" x="586.5" y="96.488" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#a80036;stroke-width:1" width="10" height="479.613" x="869.5" y="161.109" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#a80036;stroke-width:1" width="10" height="29.311" x="1102.5" y="492.525" fill="#FFF" filter="url(#ffq9v8etzm3dj)"/><rect style="stroke:#eee;stroke-width:1" width="1161.5" height="3" x="3" y="117.144" fill="#EEE" filter="url(#ffq9v8etzm3dj)"/><line style="stroke:#000;stroke-width:1" x1="3" x2="1164.5" y1="117.144" y2="117.144"/><line style="stroke:#000;stroke-width:1" x1="3" x2="1164.5" y1="120.144" y2="120.144"/><rect style="stroke:#000;stroke-width:2" width="191" height="23.311" x="488.25" y="106.488" fill="#EEE" filter="url(#ffq9v8etzm3dj)"/><text x="494.25" y="123.057" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173">RS intializes PartProtector</text><polygon fill="#A80036" points="857.5 157.109 867.5 161.109 857.5 165.109 861.5 161.109" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="596.5" x2="863.5" y1="161.109" y2="161.109"/><text x="603.5" y="156.367" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9">1</text><text x="616.5" y="156.367" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66">mkDefault</text><polygon fill="#A80036" points="422 186.42 412 190.42 422 194.42 418 190.42" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="416" x2="868.5" y1="190.42" y2="190.42"/><text x="428" y="185.678" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9">2</text><text x="441" y="185.678" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229">/.well-known/openid-configuration</text><polygon fill="#A80036" points="857.5 215.731 867.5 219.731 857.5 223.731 861.5 219.731" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="406" x2="863.5" y1="219.731" y2="219.731"/><text x="413" y="214.988" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9">3</text><text x="426" y="214.988" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107">signing kyes, etc</text><rect style="stroke:#eee;stroke-width:1" width="1161.5" height="3" x="3" y="248.386" fill="#EEE" filter="url(#ffq9v8etzm3dj)"/><line style="stroke:#000;stroke-width:1" x1="3" x2="1164.5" y1="248.386" y2="248.386"/><line style="stroke:#000;stroke-width:1" x1="3" x2="1164.5" y1="251.386" y2="251.386"/><rect style="stroke:#000;stroke-width:2" width="197" height="23.311" x="485.25" y="237.731" fill="#EEE" filter="url(#ffq9v8etzm3dj)"/><text x="491.25" y="254.299" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="179">RP calling Resource Server</text><polygon fill="#A80036" points="389 288.352 399 292.352 389 296.352 393 292.352" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="89" x2="395" y1="292.352" y2="292.352"/><text x="96" y="287.609" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9">4</text><text x="109" y="287.609" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280">request a token specifying the RS as a scope</text><polygon fill="#A80036" points="100 317.662 90 321.662 100 325.662 96 321.662" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="94" x2="405" y1="321.662" y2="321.662"/><text x="106" y="316.92" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9">5</text><text x="119" y="316.92" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36">token</text><polygon fill="#A80036" points="574.5 346.973 584.5 350.973 574.5 354.973 578.5 350.973" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="89" x2="580.5" y1="350.973" y2="350.973"/><text x="96" y="346.231" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9">6</text><text x="109" y="346.231" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203">pass the Bearer token with a call</text><polygon fill="#A80036" points="857.5 376.283 867.5 380.283 857.5 384.283 861.5 380.283" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="596.5" x2="863.5" y1="380.283" y2="380.283"/><text x="603.5" y="375.541" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9">7</text><text x="616.5" y="375.541" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236">Verify(getDemand,onSuccess,onError)</text><polygon fill="#A80036" points="607.5 405.594 597.5 409.594 607.5 413.594 603.5 409.594" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="601.5" x2="868.5" y1="409.594" y2="409.594"/><text x="613.5" y="404.852" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9">8</text><text x="626.5" y="404.852" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158">getDemand(HttpContext)</text><polygon fill="#A80036" points="857.5 434.904 867.5 438.904 857.5 442.904 861.5 438.904" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="596.5" x2="863.5" y1="438.904" y2="438.904"/><text x="603.5" y="434.162" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9">9</text><text x="616.5" y="434.162" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74">the demand</text><path fill="#EEE" d="M502,453.9043 L564,453.9043 L564,460.9043 L554,470.9043 L502,470.9043 L502,453.9043" style="stroke:#000;stroke-width:1"/><rect style="stroke:#000;stroke-width:2" width="652.5" height="149.508" x="502" y="453.904" fill="none"/><text x="517" y="467.473" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17">alt</text><text x="579" y="466.539" fill="#000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="305">[the token is valid and the claims match the demands]</text><polygon fill="#A80036" points="1090.5 488.525 1100.5 492.525 1090.5 496.525 1094.5 492.525" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1" x1="879.5" x2="1096.5" y1="492.525" y2="492.525"/><text x="886.5" y="487.783" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18">10</text><text x="908.5" y="487.783" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182">onSuccess(JwtSecurityToken)</text><polygon fill="#A80036" points="890.5 517.836 880.5 521.836 890.5 525.836 886.5 521.836" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="884.5" x2="1106.5" y1="521.836" y2="521.836"/><text x="896.5" y="517.094" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18">11</text><polygon fill="#A80036" points="607.5 547.146 597.5 551.146 607.5 555.146 603.5 551.146" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="601.5" x2="868.5" y1="551.146" y2="551.146"/><text x="613.5" y="546.404" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18">12</text><text x="635.5" y="546.404" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104">Success WebPart</text><line style="stroke:#000;stroke-width:1;stroke-dasharray:2,2" x1="502" x2="1154.5" y1="560.146" y2="560.146"/><text x="507" y="570.781" fill="#000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="339">[the token is invalid or the claims fail to meet the demands]</text><polygon fill="#A80036" points="607.5 591.412 597.5 595.412 607.5 599.412 603.5 595.412" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="601.5" x2="868.5" y1="595.412" y2="595.412"/><text x="613.5" y="590.67" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18">13</text><text x="635.5" y="590.67" fill="#000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84">Error WebPart</text><polygon fill="#A80036" points="100 627.723 90 631.723 100 635.723 96 631.723" style="stroke:#a80036;stroke-width:1"/><line style="stroke:#a80036;stroke-width:1;stroke-dasharray:2,2" x1="94" x2="585.5" y1="631.723" y2="631.723"/><text x="106" y="626.981" fill="#000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18">14</text></g></svg>